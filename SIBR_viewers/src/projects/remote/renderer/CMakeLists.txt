# Copyright (C) 2023, Inria
# GRAPHDECO research group, https://team.inria.fr/graphdeco
# All rights reserved.
#
# This software is free for non-commercial, research and evaluation use
# under the terms of the LICENSE.md file.
#
# For inquiries contact sibr@inria.fr and/or George.Drettakis@inria.fr

set(SIBR_PROJECT "remote")
project(sibr_${SIBR_PROJECT})

file(GLOB SOURCES "*.cpp" "*.h" "*.hpp")
source_group("Source Files" FILES ${SOURCES})

file(GLOB SHADERS "shaders/*.frag" "shaders/*.vert" "shaders/*.geom")
source_group("Source Files\\shaders" FILES ${SHADERS})

file(GLOB SOURCES "*.cpp" "*.h" "*.hpp" "shaders/*.frag" "shaders/*.vert" "shaders/*.geom")

# # Specify target rules
add_library(${PROJECT_NAME} SHARED ${SOURCES})

target_include_directories(${PROJECT_NAME}
  PRIVATE
  ${CMAKE_CURRENT_SOURCE_DIR}
  ${Boost_INCLUDE_DIRS}
)

if(UNIX AND NOT APPLE)
  target_link_options(${PROJECT_NAME} PRIVATE "-Wl,--no-as-needed")
endif()

target_link_libraries(${PROJECT_NAME}
  PRIVATE
  ${Boost_LIBRARIES}
  ${ASSIMP_LIBRARIES}
  ${OpenCV_LIBS}
  OpenGL::GL
  GLEW::GLEW
  glfw
  sibr_system
  sibr_view
  sibr_assets
  sibr_renderer
  sibr_basic
)

add_definitions(-DSIBR_EXP_ULR_EXPORTS -DBOOST_ALL_DYN_LINK)

set_target_properties(${PROJECT_NAME} PROPERTIES FOLDER "projects/${SIBR_PROJECT}/renderer")

# # High level macro to install in an homogen way all our ibr targets
include(install_runtime)
ibr_install_target(${PROJECT_NAME}
  INSTALL_PDB # # mean install also MSVC IDE *.pdb file (DEST according to target type)
  SHADERS ${SHADERS}
  RSC_FOLDER ${SIBR_PROJECT}

  # STANDALONE  ${INSTALL_STANDALONE}   ## mean call install_runtime with bundle dependencies resolution
  COMPONENT ${PROJECT_NAME}_install # # will create custom target to install only this project
)
